<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link href="https://cdn.bootcss.com/normalize/7.0.0/normalize.min.css" rel="stylesheet">
	<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
	<style>
		.waterFull{
			max-width: 1600px;
			margin: 0 auto;
			font-size: 0;
			position: relative;
		}
		.waterFull img{
			width: 300px;
			position: absolute;
			border: 1px solid #ccc;
			box-shadow: 5px 5px 5px #ccc;
			padding: 5px;
			margin: 5px;
			transition: all 0.5s; 
		}
		
	</style>
	<script type="text/javascript">
	$(function(){
		var waterFull = (function(){
			var hArr,helf,$imgs,num;
			var $box = $(".waterFull");
			var timer,timer1;
			var obj = {
				init:function(){
					hArr = [];
					$imgs = $box.find("img");
					num = Math.floor($box.width()/$imgs.outerWidth(true));
					helf = Math.floor(($box.width() - num*$imgs.outerWidth(true))/2);
					for(var i=0;i<num;i++){
						hArr[i] = 0;
					}
					//console.log(hArr)
					obj.rander();
					
				},
				rander: function(){
					$imgs.each(function(index,e){
						var minH = Math.min.apply(null,hArr);
						var minIndex = hArr.indexOf(minH)
						//console.log(hArr)
						$(e).css({
							top:hArr[minIndex],
							left:minIndex*$(e).outerWidth(true)+helf
						})
						hArr[minIndex] += $(e).outerHeight(true);
					})
				},
				isVisible: function($node){ 
					var wTop = $(window).scrollTop();
					var wH = window.innerHeight;
					if($node){
						if(wH+wTop>$node.offset().top&&$node.offset().top>wTop){
							return true ;
						}else{
							return false ;
						}
					}
				},
				addImg: function(){
					if(timer){clearTimeout(timer)}
					timer = setTimeout(function(){
						console.log(11);
						if(obj.isVisible($imgs.eq(-1))){
							var num = Math.floor(Math.random()*20)+1;
							var string = `<img src="http://opor4s8bz.bkt.clouddn.com/`+num+`.jpg">`
							$box.append(string);
							obj.init();
						}
					},10)
				}
			}
			return obj;
		})()
		var timer;
		$(window).resize(function(event) {
			waterFull.init();
		});
		$(window).scroll(function(){
			waterFull.addImg();
		})
		waterFull.init();
	})
	</script>
</head>
<body>
	<div class="waterFull">
		<img src="http://opor4s8bz.bkt.clouddn.com/1.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/2.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/3.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/4.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/5.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/6.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/7.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/8.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/9.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/10.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/11.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/12.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/13.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/14.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/15.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/16.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/17.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/18.jpg">
		<img src="http://opor4s8bz.bkt.clouddn.com/19.jpg">
	</div>
</body>
</html>